---
schema_template:
    create table t1(id bigint, parent bigint, primary key(id))
    create index childIdx as select id, parent from t1 order by id, parent
---
test_block:
  name: recursive-cte-tests-with-hints
  preset: single_repetition_ordered
  tests:
    -
      - query: with recursive c1 as (
            select id, parent, 0 as level from t1 use index (childIdx) where id = 250
            union all
            select b.id, b.parent, a.y as level from t1 as b use index (childIdx), (select id, parent, level + 1 as y from c1) as a  where b.id = a.parent)
            traversal order pre_order
            select id, parent, level from c1
      - supported_version: 4.7.3.0
      - explain: "RUNION-DFS PREORDER q0 { COVERING(CHILDIDX [EQUALS promote(@c24 AS LONG)] -> [ID: KEY:[0], PARENT: KEY:[1]]) | MAP (_.ID AS ID, _.PARENT AS PARENT, @c11 AS LEVEL) } { RECURSIVE COVERING(CHILDIDX [EQUALS q0.PARENT] -> [ID: KEY:[0], PARENT: KEY:[1]]) | MAP (_.ID AS ID, _.PARENT AS PARENT, q0.LEVEL + @c59 AS LEVEL) } | MAP (_.ID AS ID, _.PARENT AS PARENT, _.LEVEL AS LEVEL)"
      - result: []
...

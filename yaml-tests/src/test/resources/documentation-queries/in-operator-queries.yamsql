---
schema_template:
    create table products(id bigint, name string, category string, price bigint, stock integer, primary key(id))
    create index price_idx as select price from products order by price
    create index category_idx as select category from products order by category
    create index name_idx as select name from products order by name
---
setup:
  steps:
    - query: insert into products
            values (1, 'Widget A', 'Electronics', 100, 50),
                   (2, 'Widget B', 'Electronics', 150, 30),
                   (3, 'Gadget X', 'Electronics', 200, 20),
                   (4, 'Tool A', 'Hardware', 80, 100),
                   (5, 'Tool B', 'Hardware', 120, 15),
                   (6, 'Book A', 'Media', 25, 200),
                   (7, 'Book B', 'Media', 30, 150)
---
test_block:
  name: in-operator-tests
  preset: single_repetition_ordered
  tests:
    # IN with numbers
    -
      - query: SELECT name, price
              FROM products
              WHERE id IN (1, 3, 5)
              ORDER BY id
      - result: [{name: "Widget A", price: 100},
                 {name: "Gadget X", price: 200},
                 {name: "Tool B", price: 120}]

    # IN with strings
    -
      - query: SELECT name, category
              FROM products
              WHERE category IN ('Electronics', 'Media')
              ORDER BY name
      - result: [{name: "Book A", category: "Media"},
                          {name: "Book B", category: "Media"},
                          {name: "Gadget X", category: "Electronics"},
                          {name: "Widget A", category: "Electronics"},
                          {name: "Widget B", category: "Electronics"}]

    # NOT IN
    -
      - query: SELECT name, category
              FROM products
              WHERE category NOT IN ('Electronics', 'Media')
              ORDER BY name
      - result: [{name: "Tool A", category: "Hardware"},
                 {name: "Tool B", category: "Hardware"}]

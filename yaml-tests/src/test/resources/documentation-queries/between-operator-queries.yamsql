---
options:
  supported_version: 4.3.5.0
---
schema_template:
    create table products(id bigint, name string, category string, price bigint, stock integer, primary key(id))
    create index price_idx as select price from products order by price
    create index category_idx as select category from products order by category
    create index name_idx as select name from products order by name
---
setup:
  steps:
    - query: insert into products
            values (1, 'Widget A', 'Electronics', 100, 50),
                   (2, 'Widget B', 'Electronics', 150, 30),
                   (3, 'Gadget X', 'Electronics', 200, 20),
                   (4, 'Tool A', 'Hardware', 80, 100),
                   (5, 'Tool B', 'Hardware', 120, 15),
                   (6, 'Book A', 'Media', 25, 200),
                   (7, 'Book B', 'Media', 30, 150)
---
test_block:
  name: between-operator-tests
  preset: single_repetition_ordered
  tests:
    # BETWEEN with numbers
    -
      - query: SELECT name, price
              FROM products
              WHERE price BETWEEN 100 AND 150
              ORDER BY price
      - supported_version: 4.3.5.0
      - result: [{name: "Widget A", price: 100},
                 {name: "Tool B", price: 120},
                 {name: "Widget B", price: 150}]

    # NOT BETWEEN
    -
      - query: SELECT name, price
              FROM products
              WHERE price NOT BETWEEN 100 AND 150
              ORDER BY price
      - supported_version: 4.3.5.0
      - result: [{name: "Book A", price: 25},
                 {name: "Book B", price: 30},
                 {name: "Tool A", price: 80},
                 {name: "Gadget X", price: 200}]

    # BETWEEN with equal bounds
    -
      - query: SELECT name, price
              FROM products
              WHERE price BETWEEN 100 AND 100
      - supported_version: 4.3.5.0
      - result: [{name: "Widget A", price: 100}]

    # Empty Range
    -
      - query: SELECT name, price
              FROM products
              WHERE price BETWEEN 150 AND 100
      - supported_version: 4.3.5.0
      - result: []

    # Combined with OR
    -
      - query: SELECT name, price
              FROM products
              WHERE price BETWEEN 80 AND 100 OR price BETWEEN 180 AND 220 ORDER BY PRICE
      - supported_version: 4.3.5.0
      - result: [ {name: "Tool A", price: 80}, {name: "Widget A", price: 100}, {name: "Gadget X", price: 200} ]

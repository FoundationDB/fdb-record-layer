recursive-cte-tests:
-   query: EXPLAIN with recursive c1 as ( select id, parent, 0 as level from t1 where
        id = 250 union all select b.id, b.parent, a.y as level from t1 as b, (select
        id, parent, level + 1 as y from c1) as a  where a.parent = b.id) traversal
        order pre_order select id, parent, level from c1
    ref: recursive-cte.yamsql:41
    explain: 'RUNION-DFS PREORDER q0 { COVERING(CHILDIDX [EQUALS promote(@c19 AS LONG)]
        -> [ID: KEY:[0], PARENT: KEY:[1]]) | MAP (_.ID AS ID, _.PARENT AS PARENT,
        @c11 AS LEVEL) } { RECURSIVE COVERING(PARENTIDX <,> -> [ID: KEY:[1], PARENT:
        KEY:[0]]) | FILTER q0.PARENT EQUALS _.ID | MAP (_.ID AS ID, _.PARENT AS PARENT,
        q0.LEVEL + @c49 AS LEVEL) } | MAP (_.ID AS ID, _.PARENT AS PARENT, _.LEVEL
        AS LEVEL)'
    task_count: 1854
    task_total_time_ms: 28
    transform_count: 417
    transform_time_ms: 8
    transform_yield_count: 117
    insert_time_ms: 1
    insert_new_count: 262
    insert_reused_count: 11
-   query: EXPLAIN with recursive c1 as ( select id, parent, 0 as level from t1 where
        id = 250 union all select b.id, b.parent, a.y as level from t1 as b, (select
        id, parent, level + 1 as y from c1) as a  where a.parent = b.id) traversal
        order post_order select id, parent, level from c1
    ref: recursive-cte.yamsql:54
    explain: 'RUNION-DFS POSTORDER q0 { COVERING(CHILDIDX [EQUALS promote(@c19 AS
        LONG)] -> [ID: KEY:[0], PARENT: KEY:[1]]) | MAP (_.ID AS ID, _.PARENT AS PARENT,
        @c11 AS LEVEL) } { RECURSIVE COVERING(PARENTIDX <,> -> [ID: KEY:[1], PARENT:
        KEY:[0]]) | FILTER q0.PARENT EQUALS _.ID | MAP (_.ID AS ID, _.PARENT AS PARENT,
        q0.LEVEL + @c49 AS LEVEL) } | MAP (_.ID AS ID, _.PARENT AS PARENT, _.LEVEL
        AS LEVEL)'
    task_count: 1854
    task_total_time_ms: 23
    transform_count: 417
    transform_time_ms: 6
    transform_yield_count: 117
    insert_time_ms: 1
    insert_new_count: 262
    insert_reused_count: 11
-   query: EXPLAIN with recursive c1 as ( select id, parent, 0 as level from t1 where
        id = 250 union all select b.id, b.parent, a.y as level from (select id, parent,
        level + 1 as y from c1) as a, t1 as b where a.parent = b.id) traversal order
        level_order select id, parent, level from c1
    ref: recursive-cte.yamsql:67
    explain: 'RUNION q0, q1 { INITIAL { COVERING(CHILDIDX [EQUALS promote(@c19 AS
        LONG)] -> [ID: KEY:[0], PARENT: KEY:[1]]) | MAP (_.ID AS ID, _.PARENT AS PARENT,
        @c11 AS LEVEL) | INSERT INTO TEMP q1 } RECURSIVE  { ISCAN(CHILDIDX <,>) |
        FLATMAP q2 -> { TEMP SCAN base() | FILTER _.PARENT EQUALS q2.ID AS q3 RETURN
        (q2.ID AS ID, q2.PARENT AS PARENT, q3.LEVEL + @c45 AS LEVEL) } | INSERT INTO
        TEMP q1 }} | MAP (_.ID AS ID, _.PARENT AS PARENT, _.LEVEL AS LEVEL)'
    task_count: 1447
    task_total_time_ms: 20
    transform_count: 361
    transform_time_ms: 7
    transform_yield_count: 102
    insert_time_ms: 1
    insert_new_count: 198
    insert_reused_count: 11
-   query: EXPLAIN with recursive c1 as ( select id, parent from t1 where parent =
        -1 union all select b.id, b.parent from c1 as a, t1 as b where a.id = b.parent)
        select id from c1
    ref: recursive-cte.yamsql:77
    explain: 'RUNION-DFS PREORDER q0 { ISCAN(PARENTIDX [EQUALS promote(@c15 AS LONG)])
        } { RECURSIVE COVERING(PARENTIDX <,> -> [ID: KEY:[1], PARENT: KEY:[0]]) |
        FILTER q0.ID EQUALS _.PARENT | MAP (_.ID AS ID, _.PARENT AS PARENT) } | MAP
        (_.ID AS ID)'
    task_count: 2205
    task_total_time_ms: 28
    transform_count: 441
    transform_time_ms: 7
    transform_yield_count: 133
    insert_time_ms: 1
    insert_new_count: 328
    insert_reused_count: 9
-   query: EXPLAIN with recursive c1 as ( select id, parent from t1 where parent =
        -1 union all select b.id, b.parent from c1 as a, t1 as b where a.id = b.parent)
        traversal order post_order select id from c1
    ref: recursive-cte.yamsql:107
    explain: 'RUNION-DFS POSTORDER q0 { ISCAN(PARENTIDX [EQUALS promote(@c15 AS LONG)])
        } { RECURSIVE COVERING(PARENTIDX <,> -> [ID: KEY:[1], PARENT: KEY:[0]]) |
        FILTER q0.ID EQUALS _.PARENT | MAP (_.ID AS ID, _.PARENT AS PARENT) } | MAP
        (_.ID AS ID)'
    task_count: 2166
    task_total_time_ms: 28
    transform_count: 435
    transform_time_ms: 7
    transform_yield_count: 130
    insert_time_ms: 1
    insert_new_count: 318
    insert_reused_count: 9
-   query: EXPLAIN with recursive c1 as ( select id, parent from t1 where parent =
        -1 union all select b.id, b.parent from c1 as a, t1 as b where a.id = b.parent)
        traversal order level_order select id from c1
    ref: recursive-cte.yamsql:125
    explain: RUNION q0, q1 { INITIAL { ISCAN(PARENTIDX [EQUALS promote(@c15 AS LONG)])
        | INSERT INTO TEMP q1 } RECURSIVE  { ISCAN(CHILDIDX <,>) | FLATMAP q2 -> {
        TEMP SCAN base() | FILTER _.ID EQUALS q2.PARENT AS q3 RETURN (q2.ID AS ID,
        q2.PARENT AS PARENT) } | INSERT INTO TEMP q1 }} | MAP (_.ID AS ID)
    task_count: 1333
    task_total_time_ms: 19
    transform_count: 321
    transform_time_ms: 6
    transform_yield_count: 99
    insert_time_ms: 1
    insert_new_count: 186
    insert_reused_count: 9
-   query: EXPLAIN with recursive c1 as ( select id, parent from t1 where id = 250
        union all select b.id, b.parent from c1 as a, t1 as b where a.parent = b.id)
        select id from c1
    ref: recursive-cte.yamsql:140
    explain: 'RUNION-DFS PREORDER q0 { ISCAN(CHILDIDX [EQUALS promote(@c15 AS LONG)])
        } { RECURSIVE COVERING(PARENTIDX <,> -> [ID: KEY:[1], PARENT: KEY:[0]]) |
        FILTER q0.PARENT EQUALS _.ID | MAP (_.ID AS ID, _.PARENT AS PARENT) } | MAP
        (_.ID AS ID)'
    task_count: 2205
    task_total_time_ms: 29
    transform_count: 441
    transform_time_ms: 7
    transform_yield_count: 133
    insert_time_ms: 1
    insert_new_count: 328
    insert_reused_count: 9
-   query: EXPLAIN with recursive c1 as ( select id, parent from t1 where id = 250
        union all select b.id, b.parent from c1 as a, t1 as b where a.parent = b.id)
        traversal order level_order select id from c1
    ref: recursive-cte.yamsql:153
    explain: RUNION q0, q1 { INITIAL { ISCAN(CHILDIDX [EQUALS promote(@c15 AS LONG)])
        | INSERT INTO TEMP q1 } RECURSIVE  { ISCAN(CHILDIDX <,>) | FLATMAP q2 -> {
        TEMP SCAN base() | FILTER _.PARENT EQUALS q2.ID AS q3 RETURN (q2.ID AS ID,
        q2.PARENT AS PARENT) } | INSERT INTO TEMP q1 }} | MAP (_.ID AS ID)
    task_count: 1333
    task_total_time_ms: 18
    transform_count: 321
    transform_time_ms: 5
    transform_yield_count: 99
    insert_time_ms: 1
    insert_new_count: 186
    insert_reused_count: 9
-   query: EXPLAIN with recursive c1 as ( select id, parent from t1 where id = 250
        union all select b.id, b.parent from c1 as a, t1 as b where a.parent = b.id)
        traversal order pre_order select id from c1
    ref: recursive-cte.yamsql:166
    explain: 'RUNION-DFS PREORDER q0 { ISCAN(CHILDIDX [EQUALS promote(@c15 AS LONG)])
        } { RECURSIVE COVERING(PARENTIDX <,> -> [ID: KEY:[1], PARENT: KEY:[0]]) |
        FILTER q0.PARENT EQUALS _.ID | MAP (_.ID AS ID, _.PARENT AS PARENT) } | MAP
        (_.ID AS ID)'
    task_count: 2166
    task_total_time_ms: 26
    transform_count: 435
    transform_time_ms: 6
    transform_yield_count: 130
    insert_time_ms: 1
    insert_new_count: 318
    insert_reused_count: 9
-   query: EXPLAIN with recursive c1 as ( select id, parent from t1 where id = 250
        union all select b.id, b.parent from c1 as a, t1 as b where a.parent = b.id)
        traversal order post_order select id from c1
    ref: recursive-cte.yamsql:179
    explain: 'RUNION-DFS POSTORDER q0 { ISCAN(CHILDIDX [EQUALS promote(@c15 AS LONG)])
        } { RECURSIVE COVERING(PARENTIDX <,> -> [ID: KEY:[1], PARENT: KEY:[0]]) |
        FILTER q0.PARENT EQUALS _.ID | MAP (_.ID AS ID, _.PARENT AS PARENT) } | MAP
        (_.ID AS ID)'
    task_count: 2166
    task_total_time_ms: 27
    transform_count: 435
    transform_time_ms: 6
    transform_yield_count: 130
    insert_time_ms: 1
    insert_new_count: 318
    insert_reused_count: 9
-   query: EXPLAIN with recursive allDescendants as ( with recursive ancestorsOf250
        as ( select id, parent from t1 where id = 250 union all select b.id, b.parent
        from ancestorsOf250 as a, t1 as b where a.parent = b.id) select id, parent
        from ancestorsOf250 union all select b.id, b.parent from allDescendants as
        a, t1 as b where a.id = b.parent) select id, parent from allDescendants
    ref: recursive-cte.yamsql:192
    explain: 'RUNION-DFS PREORDER q0 { RUNION-DFS PREORDER q1 { ISCAN(CHILDIDX [EQUALS
        promote(@c20 AS LONG)]) } { RECURSIVE COVERING(PARENTIDX <,> -> [ID: KEY:[1],
        PARENT: KEY:[0]]) | FILTER q1.PARENT EQUALS _.ID | MAP (_.ID AS ID, _.PARENT
        AS PARENT) } | MAP (_.ID AS ID, _.PARENT AS PARENT) } { RECURSIVE COVERING(PARENTIDX
        <,> -> [ID: KEY:[1], PARENT: KEY:[0]]) | FILTER q0.ID EQUALS _.PARENT | MAP
        (_.ID AS ID, _.PARENT AS PARENT) } | MAP (_.ID AS ID, _.PARENT AS PARENT)'
    task_count: 3437
    task_total_time_ms: 43
    transform_count: 707
    transform_time_ms: 10
    transform_yield_count: 204
    insert_time_ms: 3
    insert_new_count: 518
    insert_reused_count: 15
-   query: EXPLAIN with recursive allDescendants as ( with recursive ancestorsOf250
        as ( select id, parent from t1 where id = 250 union all select b.id, b.parent
        from ancestorsOf250 as a, t1 as b where a.parent = b.id) traversal order post_order
        select id, parent from ancestorsOf250 union all select b.id, b.parent from
        allDescendants as a, t1 as b where a.id = b.parent) traversal order post_order
        select id, parent from allDescendants
    ref: recursive-cte.yamsql:242
    explain: 'RUNION-DFS POSTORDER q0 { RUNION-DFS POSTORDER q1 { ISCAN(CHILDIDX [EQUALS
        promote(@c20 AS LONG)]) } { RECURSIVE COVERING(PARENTIDX <,> -> [ID: KEY:[1],
        PARENT: KEY:[0]]) | FILTER q1.PARENT EQUALS _.ID | MAP (_.ID AS ID, _.PARENT
        AS PARENT) } | MAP (_.ID AS ID, _.PARENT AS PARENT) } { RECURSIVE COVERING(PARENTIDX
        <,> -> [ID: KEY:[1], PARENT: KEY:[0]]) | FILTER q0.ID EQUALS _.PARENT | MAP
        (_.ID AS ID, _.PARENT AS PARENT) } | MAP (_.ID AS ID, _.PARENT AS PARENT)'
    task_count: 3147
    task_total_time_ms: 39
    transform_count: 666
    transform_time_ms: 10
    transform_yield_count: 190
    insert_time_ms: 2
    insert_new_count: 464
    insert_reused_count: 15
-   query: EXPLAIN with recursive c1 as ( select id, parent from t1 where parent =
        -1 union all select b.id, b.parent from c1 as a, t1 as b where a.id = b.parent)
        select id from c1
    ref: recursive-cte.yamsql:266
    explain: 'RUNION-DFS PREORDER q0 { ISCAN(PARENTIDX [EQUALS promote(@c15 AS LONG)])
        } { RECURSIVE COVERING(PARENTIDX <,> -> [ID: KEY:[1], PARENT: KEY:[0]]) |
        FILTER q0.ID EQUALS _.PARENT | MAP (_.ID AS ID, _.PARENT AS PARENT) } | MAP
        (_.ID AS ID)'
    task_count: 2205
    task_total_time_ms: 28
    transform_count: 441
    transform_time_ms: 7
    transform_yield_count: 133
    insert_time_ms: 1
    insert_new_count: 328
    insert_reused_count: 9
-   query: EXPLAIN with recursive c1 as ( select id, parent from t1 where parent =
        -1 union all select b.id, b.parent from c1 as a, t1 as b where a.id = b.parent)
        select id from c1
    ref: recursive-cte.yamsql:283
    explain: 'RUNION-DFS PREORDER q0 { ISCAN(PARENTIDX [EQUALS promote(@c15 AS LONG)])
        } { RECURSIVE COVERING(PARENTIDX <,> -> [ID: KEY:[1], PARENT: KEY:[0]]) |
        FILTER q0.ID EQUALS _.PARENT | MAP (_.ID AS ID, _.PARENT AS PARENT) } | MAP
        (_.ID AS ID)'
    task_count: 2205
    task_total_time_ms: 28
    transform_count: 441
    transform_time_ms: 7
    transform_yield_count: 133
    insert_time_ms: 1
    insert_new_count: 328
    insert_reused_count: 9
-   query: EXPLAIN with recursive c1 as ( select id, parent from t1 where parent =
        -1 union all select b.id, b.parent from c1 as a, t1 as b where a.id = b.parent)
        traversal order post_order select id from c1
    ref: recursive-cte.yamsql:308
    explain: 'RUNION-DFS POSTORDER q0 { ISCAN(PARENTIDX [EQUALS promote(@c15 AS LONG)])
        } { RECURSIVE COVERING(PARENTIDX <,> -> [ID: KEY:[1], PARENT: KEY:[0]]) |
        FILTER q0.ID EQUALS _.PARENT | MAP (_.ID AS ID, _.PARENT AS PARENT) } | MAP
        (_.ID AS ID)'
    task_count: 2166
    task_total_time_ms: 28
    transform_count: 435
    transform_time_ms: 7
    transform_yield_count: 130
    insert_time_ms: 1
    insert_new_count: 318
    insert_reused_count: 9
-   query: EXPLAIN with recursive allDescendants as ( with recursive ancestorsOf250
        as ( select id, parent from t1 where id = 250 union all select b.id, b.parent
        from ancestorsOf250 as a, t1 as b where a.parent = b.id) select id, parent
        from ancestorsOf250 union all select b.id, b.parent from allDescendants as
        a, t1 as b where a.id = b.parent) select id, parent from allDescendants
    ref: recursive-cte.yamsql:329
    explain: 'RUNION-DFS PREORDER q0 { RUNION-DFS PREORDER q1 { ISCAN(CHILDIDX [EQUALS
        promote(@c20 AS LONG)]) } { RECURSIVE COVERING(PARENTIDX <,> -> [ID: KEY:[1],
        PARENT: KEY:[0]]) | FILTER q1.PARENT EQUALS _.ID | MAP (_.ID AS ID, _.PARENT
        AS PARENT) } | MAP (_.ID AS ID, _.PARENT AS PARENT) } { RECURSIVE COVERING(PARENTIDX
        <,> -> [ID: KEY:[1], PARENT: KEY:[0]]) | FILTER q0.ID EQUALS _.PARENT | MAP
        (_.ID AS ID, _.PARENT AS PARENT) } | MAP (_.ID AS ID, _.PARENT AS PARENT)'
    task_count: 3437
    task_total_time_ms: 43
    transform_count: 707
    transform_time_ms: 10
    transform_yield_count: 204
    insert_time_ms: 3
    insert_new_count: 518
    insert_reused_count: 15
-   query: EXPLAIN with recursive allDescendants as ( with recursive ancestorsOf250
        as ( select id, parent from t1 where id = 250 union all select b.id, b.parent
        from ancestorsOf250 as a, t1 as b where a.parent = b.id) select id, parent
        from ancestorsOf250 union all select b.id, b.parent from allDescendants as
        a, t1 as b where a.id = b.parent) select id, parent from allDescendants
    ref: recursive-cte.yamsql:357
    explain: 'RUNION-DFS PREORDER q0 { RUNION-DFS PREORDER q1 { ISCAN(CHILDIDX [EQUALS
        promote(@c20 AS LONG)]) } { RECURSIVE COVERING(PARENTIDX <,> -> [ID: KEY:[1],
        PARENT: KEY:[0]]) | FILTER q1.PARENT EQUALS _.ID | MAP (_.ID AS ID, _.PARENT
        AS PARENT) } | MAP (_.ID AS ID, _.PARENT AS PARENT) } { RECURSIVE COVERING(PARENTIDX
        <,> -> [ID: KEY:[1], PARENT: KEY:[0]]) | FILTER q0.ID EQUALS _.PARENT | MAP
        (_.ID AS ID, _.PARENT AS PARENT) } | MAP (_.ID AS ID, _.PARENT AS PARENT)'
    task_count: 3437
    task_total_time_ms: 43
    transform_count: 707
    transform_time_ms: 10
    transform_yield_count: 204
    insert_time_ms: 3
    insert_new_count: 518
    insert_reused_count: 15
-   query: EXPLAIN with recursive allDescendants as ( with recursive ancestorsOf250
        as ( select id, parent from t1 where id = 250 union all select b.id, b.parent
        from ancestorsOf250 as a, t1 as b where a.parent = b.id) traversal order post_order
        select id, parent from ancestorsOf250 union all select b.id, b.parent from
        allDescendants as a, t1 as b where a.id = b.parent) traversal order post_order
        select id, parent from allDescendants
    ref: recursive-cte.yamsql:394
    explain: 'RUNION-DFS POSTORDER q0 { RUNION-DFS POSTORDER q1 { ISCAN(CHILDIDX [EQUALS
        promote(@c20 AS LONG)]) } { RECURSIVE COVERING(PARENTIDX <,> -> [ID: KEY:[1],
        PARENT: KEY:[0]]) | FILTER q1.PARENT EQUALS _.ID | MAP (_.ID AS ID, _.PARENT
        AS PARENT) } | MAP (_.ID AS ID, _.PARENT AS PARENT) } { RECURSIVE COVERING(PARENTIDX
        <,> -> [ID: KEY:[1], PARENT: KEY:[0]]) | FILTER q0.ID EQUALS _.PARENT | MAP
        (_.ID AS ID, _.PARENT AS PARENT) } | MAP (_.ID AS ID, _.PARENT AS PARENT)'
    task_count: 3147
    task_total_time_ms: 39
    transform_count: 666
    transform_time_ms: 10
    transform_yield_count: 190
    insert_time_ms: 2
    insert_new_count: 464
    insert_reused_count: 15
recursive-cte-tests-with-hints:
-   query: EXPLAIN with recursive c1 as ( select id, parent, 0 as level from t1 use
        index (parentIdx) where id = 250 union all select b.id, b.parent, a.y as level
        from t1 as b use index (parentIdx), (select id, parent, level + 1 as y from
        c1) as a  where a.parent = b.id) traversal order pre_order select id, parent,
        level from c1
    ref: recursive-cte.yamsql:435
    explain: 'RUNION-DFS PREORDER q0 { COVERING(PARENTIDX <,> -> [ID: KEY:[1], PARENT:
        KEY:[0]]) | FILTER _.ID EQUALS promote(@c24 AS LONG) | MAP (_.ID AS ID, _.PARENT
        AS PARENT, @c11 AS LEVEL) } { RECURSIVE COVERING(PARENTIDX <,> -> [ID: KEY:[1],
        PARENT: KEY:[0]]) | FILTER q0.PARENT EQUALS _.ID | MAP (_.ID AS ID, _.PARENT
        AS PARENT, q0.LEVEL + @c59 AS LEVEL) } | MAP (_.ID AS ID, _.PARENT AS PARENT,
        _.LEVEL AS LEVEL)'
    task_count: 1069
    task_total_time_ms: 14
    transform_count: 262
    transform_time_ms: 4
    transform_yield_count: 59
    insert_time_ms: 0
    insert_new_count: 134
    insert_reused_count: 4
-   query: EXPLAIN with recursive c1 as ( select id, parent, 0 as level from t1 use
        index (childIdx) where id = 250 union all select b.id, b.parent, a.y as level
        from t1 as b use index (childIdx), (select id, parent, level + 1 as y from
        c1) as a  where a.parent = b.id) traversal order pre_order select id, parent,
        level from c1
    ref: recursive-cte.yamsql:448
    explain: 'RUNION-DFS PREORDER q0 { COVERING(CHILDIDX [EQUALS promote(@c24 AS LONG)]
        -> [ID: KEY:[0], PARENT: KEY:[1]]) | MAP (_.ID AS ID, _.PARENT AS PARENT,
        @c11 AS LEVEL) } { RECURSIVE COVERING(CHILDIDX <,> -> [ID: KEY:[0], PARENT:
        KEY:[1]]) | FILTER q0.PARENT EQUALS _.ID | MAP (_.ID AS ID, _.PARENT AS PARENT,
        q0.LEVEL + @c59 AS LEVEL) } | MAP (_.ID AS ID, _.PARENT AS PARENT, _.LEVEL
        AS LEVEL)'
    task_count: 1038
    task_total_time_ms: 13
    transform_count: 256
    transform_time_ms: 3
    transform_yield_count: 58
    insert_time_ms: 0
    insert_new_count: 129
    insert_reused_count: 3
-   query: EXPLAIN with recursive c1 as ( select id, parent, 0 as level from t1 use
        index (childIdx) where id = 250 and parent is not null union all select b.id,
        b.parent, a.y as level from (select parent, id from t1 use index (childIdx)
        where parent is not null and id is not null) as b, (select id, parent, level
        + 1 as y from c1) as a  where b.id = a.parent) traversal order pre_order select
        id, parent, level from c1
    ref: recursive-cte.yamsql:461
    explain: 'RUNION-DFS PREORDER q0 { COVERING(CHILDIDX [EQUALS promote(@c24 AS LONG),
        [NOT_NULL]] -> [ID: KEY:[0], PARENT: KEY:[1]]) | MAP (_.ID AS ID, _.PARENT
        AS PARENT, @c11 AS LEVEL) } { RECURSIVE COVERING(CHILDIDX [EQUALS q0.PARENT,
        [NOT_NULL]] -> [ID: KEY:[0], PARENT: KEY:[1]]) | MAP (_.ID AS ID, _.PARENT
        AS PARENT, q0.LEVEL + @c81 AS LEVEL) } | MAP (_.ID AS ID, _.PARENT AS PARENT,
        _.LEVEL AS LEVEL)'
    task_count: 1203
    task_total_time_ms: 18
    transform_count: 297
    transform_time_ms: 7
    transform_yield_count: 67
    insert_time_ms: 0
    insert_new_count: 149
    insert_reused_count: 3
